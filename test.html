<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Test CinetPay</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <h1>Test CinetPay</h1>
  <button onclick="initierPaiement()">Payer maintenant</button>

  <script>
    function initierPaiement() {
      var data = {
        apikey: "10702646756867f3ce15e078.13285887", // clé API visible — ok pour test
        site_id: "105900716",
        transaction_id: Math.floor(Math.random() * 100000000).toString(),
        amount: 10000,
        currency: "CDF",
        description: "Paiement test",
        customer_id: "172",
        customer_name: "Manima",
        customer_surname: "Marien",
        customer_email: "manimamarien08@gmail.com",
        customer_phone_number: "+243827429136",
        customer_address: "Kinshasa",
        customer_city: "Kinshasa",
        customer_country: "CD",
        customer_state: "Kinshasa",
        customer_zip_code: "00000",
        notify_url: "https://webhook.site/d1dbbb89-52c7-49af-a689-b3c412df820d", // webhook test
        return_url: "https://webhook.site/d1dbbb89-52c7-49af-a689-b3c412df820d",
        channels: "ALL",
        metadata: "user1",
        lang: "FR"
      };

      axios.post('https://api-checkout.cinetpay.com/v2/payment', data)
        .then(function (response) {
          console.log("✅ Paiement créé :", response.data);
          if (response.data && response.data.data && response.data.data.payment_url) {
            window.location.href = response.data.data.payment_url;
          } else {
            alert("Erreur : pas d'URL de paiement reçue");
          }
        })
        .catch(function (error) {
          console.error("❌ Erreur API :", error.response ? error.response.data : error);
        });
    }
  </script>
</body>
</html>
